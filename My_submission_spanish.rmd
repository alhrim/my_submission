---
title: "Citometr√≠a de flujo"
author: "David Guillermo Hern√°ndez Mej√≠a"
date: "`r format(Sys.Date(),'%A,%B,%d, %Y')`"
output:
  prettydoc::html_pretty:
    toc: true
    theme: cayman
    highlight: github
---
```{r setup, include=FALSE}
# define knitr options
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(message = FALSE)

# set any missing NAs in table to blank
options(knitr.kable.NA='')

# load R packages
library(fivethirtyeight)
library(tidyverse)
library(knitr)
library(kableExtra)
library(ggthemes)
```

## ¬øQu√© es la Citometr√≠a de Flujo?

La citometr√≠a de flujo es una t√©cnica de laboratorio utilizada para medir las propiedades f√≠sicas y qu√≠micas de las c√©lulas o part√≠culas en suspensi√≥n. Esta t√©cnica se basa en el uso de un sistema que permite analizar individualmente c√©lulas u otras part√≠culas, mientras estas fluyen en una corriente l√≠quida a trav√©s de un haz de luz l√°ser. Al atravesar el l√°ser, las part√≠culas dispersan la luz y, si est√°n marcadas con fluorocromos, emiten fluorescencia. Estos eventos de luz son capturados y convertidos en se√±ales el√©ctricas, que luego son procesadas para proporcionar informaci√≥n detallada sobre cada part√≠cula.

## ¬øPara qu√© sirve?

La **citometr√≠a de flujo** es especialmente √∫til para:

* _Identificaci√≥n y clasificaci√≥n de poblaciones celulares_: Permite la caracterizaci√≥n precisa de diferentes tipos de c√©lulas en funci√≥n de la expresi√≥n de marcadores espec√≠ficos en su superficie o en su interior.
* _Evaluaci√≥n de la viabilidad celular_: Determina el porcentaje de c√©lulas vivas, muertas o en proceso de apoptosis.
* _An√°lisis del ciclo celular_: Proporciona informaci√≥n sobre las diferentes fases del ciclo celular en una poblaci√≥n celular.
* _Detecci√≥n de prote√≠nas intracelulares y citocinas_: Eval√∫a la presencia y cantidad de prote√≠nas y mol√©culas importantes para la funci√≥n celular.

La versatilidad de la citometr√≠a de flujo la convierte en una t√©cnica indispensable en la investigaci√≥n biom√©dica y en el diagn√≥stico cl√≠nico, permitiendo un an√°lisis detallado y cuantitativo de la diversidad celular en muestras complejas.

## ¬øC√≥mo Funciona la Citometr√≠a de Flujo?


La citometr√≠a de flujo se basa en la interacci√≥n de c√©lulas o part√≠culas con un sistema √≥ptico compuesto por un l√°ser y detectores. A continuaci√≥n, se describen los pasos principales en el funcionamiento de esta t√©cnica:

* **1.Preparaci√≥n de la Muestra**:
Las c√©lulas o part√≠culas a analizar se suspenden en un fluido. Estas c√©lulas pueden estar previamente marcadas con anticuerpos espec√≠ficos conjugados a fluorocromos, que se unir√°n a mol√©culas espec√≠ficas presentes en la superficie o en el interior de las c√©lulas.

* **2.Inyecci√≥n de la Muestra**:
La suspensi√≥n celular es inyectada en el cit√≥metro de flujo, donde las c√©lulas fluyen individualmente a trav√©s de un canal estrecho. Este flujo es laminar y ordenado, permitiendo que las c√©lulas pasen una por una frente al haz de l√°ser.

* **3.Interacci√≥n con el L√°ser**:
Cada c√©lula que pasa por el l√°ser dispersa la luz en diferentes √°ngulos (dispersi√≥n hacia adelante y lateral). Adem√°s, si la c√©lula ha sido marcada con fluorocromos, estos se excitan y emiten luz a una longitud de onda espec√≠fica.

![Ilustraci√≥n de la citometr√≠a de flujo](images/FC_1.png)


* **4.Detecci√≥n y Recopilaci√≥n de Datos**: Los detectores captan tanto la luz dispersa como la fluorescencia emitida por las c√©lulas. La dispersi√≥n hacia adelante (FSC) proporciona informaci√≥n sobre el tama√±o celular, mientras que la dispersi√≥n lateral (SSC) est√° relacionada con la complejidad interna o granularidad de la c√©lula. Los diferentes fluorocromos emiten fluorescencia en longitudes de onda espec√≠ficas, y sus se√±ales son recogidas por detectores individuales.

* **5.An√°lisis de Datos**: Las se√±ales detectadas son convertidas en impulsos el√©ctricos y posteriormente digitalizadas. Estos datos se procesan para generar gr√°ficos como histogramas o diagramas de puntos, que permiten la visualizaci√≥n y an√°lisis de las diferentes poblaciones celulares en funci√≥n de los par√°metros medidos. Uno de los c√°lculos matem√°ticos utilizados es el de la media de fluorescencia (Mean Fluorescence Intensity, MFI), que se emplea para cuantificar la expresi√≥n de marcadores espec√≠ficos en una poblaci√≥n celular. Esta se calcula como:

$$ MFI= 1/N  \sum_{i=1}^{N} F_i $$
Donde:
  + ùëÅ es el n√∫mero total de eventos (c√©lulas) analizados.
  + $ùêπ_i$ es la intensidad de fluorescencia del evento 

## Interpretaci√≥n

Los resultados obtenidos pueden ser interpretados para entender la composici√≥n de la muestra, la expresi√≥n de mol√©culas espec√≠ficas, y otros aspectos relevantes seg√∫n el experimento o diagn√≥stico realizado.

![Estrategia de gating](images/FC_2.png)

La tabla de resultados muestra el porcentaje de c√©lulas que pertenecen a cada una de las poblaciones definidas a trav√©s del proceso de gating. Estos porcentajes reflejan la proporci√≥n de c√©lulas dentro del total de eventos analizados que cumplen con los criterios espec√≠ficos de cada gate.



```{r  fig.width=6, fig.height=6, fig.align='center', echo=FALSE}

# Establecer una semilla para la reproducibilidad
set.seed(123)

# Generar un data frame con porcentajes aleatorios para 8 poblaciones celulares
# Cada fila representa una muestra
# Los porcentajes se generan de manera que sumen aproximadamente 100%

# Nombres de las poblaciones celulares
poblaciones <- c("C√©lulas T CD4+", "C√©lulas T CD8+", "C√©lulas B", "C√©lulas NK", 
                 "Monocitos", "C√©lulas Dendr√≠ticas", "Granulocitos", "C√©lulas Madre")

# Crear un data frame vac√≠o
tabla_resultados <- data.frame(matrix(ncol = length(poblaciones), nrow = 10))

# Asignar nombres a las columnas
colnames(tabla_resultados) <- poblaciones

# Rellenar la tabla con valores aleatorios
for (i in 1:nrow(tabla_resultados)) {
  # Generar 8 porcentajes aleatorios
  porcentajes <- runif(8, min = 5, max = 20)
  
  # Normalizar para que sumen aproximadamente 100%
  porcentajes <- porcentajes / sum(porcentajes) * 100
  
  # Asignar los porcentajes a la fila i
  tabla_resultados[i, ] <- round(porcentajes, 2)
}

# Asignar nombres a las filas (Muestra 1, Muestra 2, etc.)
rownames(tabla_resultados) <- paste("Muestra", 1:10)
```


```{r, echo=FALSE, results='asis'}
knitr::kable(tabla_resultados)
```


## Visualizaci√≥n

La visualizaci√≥n de la tabla generada en el an√°lisis de citometr√≠a de flujo permite observar la distribuci√≥n porcentual de distintas poblaciones celulares a trav√©s de m√∫ltiples muestras. Esta representaci√≥n es crucial para identificar patrones y comparaciones entre las muestras, facilitando el an√°lisis de variaciones en la presencia y proporci√≥n de c√©lulas inmunitarias espec√≠ficas, como c√©lulas T, c√©lulas B, y c√©lulas NK, entre otras ^[ Distribuci√≥n porcentual de diferentes poblaciones celulares en las muestras analizadas. Los boxplots muestran la variabilidad y la dispersi√≥n de los datos para cada poblaci√≥n celular, proporcionando una visi√≥n clara de la distribuci√≥n y posibles outliers en el conjunto de datos]. 

```{r, echo=FALSE, warning=FALSE}
# install.packages("ggplot2")
library(ggplot2)

# Crear un scatter plot para visualizar C√©lulas T CD4+ frente a C√©lulas T CD8+
ggplot(tabla_resultados, aes(x = tabla_resultados$`C√©lulas T CD4+`, 
                             y = tabla_resultados$`C√©lulas T CD8+`)) +
  geom_point(color = "blue", size = 3) +
  labs(title = "C√©lulas T CD4+ vs C√©lulas T CD8+",
       x = "Porcentaje de C√©lulas T CD4+",
       y = "Porcentaje de C√©lulas T CD8+") +
  theme_minimal()
```
```{r, echo=FALSE, warning=FALSE}
boxplot(tabla_resultados, col = "orange")
```


